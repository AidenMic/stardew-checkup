<!DOCTYPE html>
<html>
<head>
<title>Stardew Checkup</title>
<meta charset="UTF-8" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<style type="text/css">
	html {
		min-height: 100%;
		background-attachment: fixed;
		background-color: #80a0f0; /* fallback color if gradients are not supported */
		background-image: -webkit-linear-gradient(top, #80a0f0, #c0ffff, #40c040); /* For Chrome 25 and Safari 6, iOS 6.1, Android 4.3 */
		background-image:    -moz-linear-gradient(top, #80a0f0, #c0ffff, #40c040); /* For Firefox (3.6 to 15) */
		background-image:      -o-linear-gradient(top, #80a0f0, #c0ffff, #40c040); /* For old Opera (11.1 to 12.0) */ 
		background-image:         linear-gradient(to bottom, #80a0f0, #c0ffff, #40c040); /* Standard syntax; must be last */
	}
	body {
		/* background-color: #ffe0b0; */
		margin: 15px;
		color: #603000;
	}
	a:link { color: #d06000; }
	a:visited { color: #804000; }
	a:hover,a:active { color: #ffa000; }
	.panel {
		background-color: #ffe0b0;
		padding: 8px;
		margin: 5px;
		border: 5px solid #804000;
		border-radius: 15px;
	}
	#input-container { display: none; }
	#output-container { display: none; }
	.error {
		font-weight: bold;
		font-size: 150%;
		color: #ff0000;
	}
	.path {
		font-family: monospace;
	}
	#footer {
		text-align: center;
	}
	.ach {
		font-style: italic;
	}
	.ach_yes,.ms_yes {
		color: #004000;
	}
	.ach_yes:before,.ms_yes:before {
		content: "\2714 ";
		margin-right: 3px;
	}
	.ach_no,.ms_no {
		color: #c00000;
	}
	.ach_no:before,.ms_no:before {
		content: "\2718 ";
		margin-right: 3px;
	}
	.ach_list {
		list-style: none;
		padding-left: 35px;
		margin-top: 0px;
	}
	.result:before {
		content: "\25c8 ";
		margin-right: 3px;
	}
	.result {
		padding-left: 15px;
	}
	.need:before {
		content: "! ";
		font-weight: bold;
		margin-right: 3px;
	}
	.need {
		margin-left: 38px;
	}
	.need > ul{
		margin-left: 48px;
		margin-top: 0px;
	}
	.need > ol{
		margin-left: 48px;
		margin-top: 0px;
	}
</style>
</head>
<body>
<div id="header" class="panel">
<h1>Stardew Checkup</h1>
<h2>About</h2>
<p>This script checks a <a href="http://stardewvalley.net/">Stardew Valley</a> save file for various achievements and milestones and
lets you know what is missing.</p>
<p>The newest version of the script is available on GitHub Pages at <a href="https://mouseypounds.github.io/stardew-checkup/">https://mouseypounds.github.io/stardew-checkup/</a> and the source code repository is <a href="https://github.com/MouseyPounds/stardew-checkup">https://github.com/MouseyPounds/stardew-checkup</a>.</p>

</div>

<div id="input-container" class="panel">
<h2>Save File</h2>
<p>Select a save file to check: <input type="file" id="file_select" /></p>
<p>Standard save file locations are:
<ul><li>Windows: <span class="path">%AppData%\StardewValley\Saves\</span></li>
<li>Mac OSX & Linux: <span class="path">~/.config/StardewValley/Saves/</span></li>
</ol>
</div>

<div id="output-container" class="panel">
<h2>Results</h2>
<output id="out"> </output>
</div>

<div id="changelog" class="panel">
<noscript><span class="error">Javascript appears to be unsupported by or disabled in your browser. Stardew Checkup will not work without it.</span></noscript>
<h2>Changelog</h2>
<ul>
<li>20 June 2017 - v1.0 - Initial Release
</ul>
</div>

<div id="footer" class="panel">
Stardew Valley resources: <a href="http://stardewvalley.net/">Website</a> || 
<a href="http://store.steampowered.com/app/413150/Stardew_Valley/">Steam Page</a> ||
<a href="https://www.gog.com/game/stardew_valley">GOG Page</a> ||
<a href="http://www.stardewvalleywiki.com/">Wiki</a> || 
<a href="http://community.playstarbound.com/index.php?forums/stardew-valley.72/">Forums</a> ||
<a href="https://www.reddit.com/r/StardewValley">Subreddit</a>
<br />
Stardew Checkup written by MouseyPounds. 
Stardew Valley developed by <a href="http://twitter.com/concernedape">ConcernedApe</a> and published by 
<a href="http://blog.chucklefish.org/about/">Chucklefish Games</a>.
</div>
<script>
window.onload=function(){
	// Check for the various File API support.
	if (!(window.File && window.FileReader)) {
		document.getElementById('out').innerHTML = '<span class="error">Fatal Error: Could not load the File & FileReader APIs</span>';
		return;
	}

	// Show input & output fields
	$(document.getElementById('input-container')).show();

	// from Jamie Taylor. See https://stackoverflow.com/questions/3883342/add-commas-to-a-number-in-jquery
	function addCommas(x) {
		return x.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ",");
	}
	
	function handleFileSelect(evt) {
		var file = evt.target.files[0];
		var reader = new FileReader();

		reader.onload = function(e) {
			$(document.getElementById('changelog')).hide();
			$(document.getElementById('output-container')).show();
			var output = "";
			var xmlDoc = $.parseXML(e.target.result);
			var seasons = ['Spring','Summer','Fall','Winter'];
			var farmer = $(xmlDoc).find('player > name').text();
			var outElement = document.getElementById('out');

			output += '<h3>Summary</h3>\n';
			output += '<span class="result">Farmer ' + farmer + ' of '
				+ $(xmlDoc).find('player > farmName').text() + ' Farm</span><br />\n';
			output += '<span class="result">Day ' + $(xmlDoc).find('player > dayOfMonthForSaveGame').text() + ' of '
				+ seasons[$(xmlDoc).find('player > seasonForSaveGame').text()] + ', Year ' +
				+ $(xmlDoc).find('player > yearForSaveGame').text() + '</span><br />\n';
			outElement.innerHTML = output;
			// I have no idea if saveTime is the elapsed time or not. 
			//var saveTime = $(xmlDoc).find('player > saveTime').text();
				
			output += '<h3>Money</h3>\n';
			var money = Number($(xmlDoc).find('player > totalMoneyEarned').text());
			output += '<span class="result">'+ farmer + ' has earned a total of ' + addCommas(money) + 'g.</span><br /><ul class="ach_list">\n';
			output += '<li>'
			output += (money >= 15000) ? '<span class="ach_yes"><span class="ach">Greenhorn</span> Achievement (earn 15,000g) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Greenhorn</span> Achievement (earn 15,000g) requirements not met</span> -- need ' + addCommas(15000-money) + 'g more';
			output += '</li>\n<li>';
			output += (money >= 50000) ? '<span class="ach_yes"><span class="ach">Cowpoke</span> Achievement (earn 50,000g) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Cowpoke</span> Achievement (earn 50,000g) requirements not met</span> -- need ' + addCommas(50000-money) + 'g more';
			output += '</li>\n<li>';
			output += (money >= 250000) ? '<span class="ach_yes"><span class="ach">Homesteader</span> Achievement (earn 250,000g) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Homesteader</span> Achievement (earn 250,000g) requirements not met</span> -- need ' + addCommas(250000-money) + 'g more';
			output += '</li>\n<li>';
			output += (money >= 1000000) ? '<span class="ach_yes"><span class="ach">Millionaire</span> Achievement (earn 1,000,000g) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Millionaire</span> Achievement (earn 1,000,000g) requirements not met</span> -- need ' + addCommas(1000000-money) + 'g more';
			output += '</li>\n<li>';
			output += (money >= 10000000) ? '<span class="ach_yes"><span class="ach">Legend</span> Achievement (earn 10,000,000g) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Legend</span> Achievement (earn 10,000,000g) requirements not met</span> -- need ' + addCommas(10000000-money) + 'g more';
			output += '</li></ul>\n';
			outElement.innerHTML = output;

			output += '<h3>Social</h3>\n';
			var count_5h = 0;
			var count_10h = 0;
			$(xmlDoc).find('player > friendships > item').each(function() {
				var who = $(this).find('key > string').text();
				var num = $(this).find('value > ArrayOfInt > int').first().text();
				if (num >= 2500) { count_10h++; }
				if (num >= 1250) { count_5h++; }
				// TODO: check for maxed out hearts on everyone
			});
			output += '<span class="result">' + farmer + ' has ' + count_5h + ' friends with 5+ hearts.</span><ul class="ach_list">\n';
			output += '<li>'
			output += (count_5h >= 1) ? '<span class="ach_yes"><span class="ach">A New Friend</span> Achievement (5&#x2764; with 1 person) requirements met</span>' :
				'<span class="ach_no"><span class="ach">A New Friend</span> Achievement (5&#x2764; with 1 person) requirements not met</span> -- need ' + (1-count_5h) + ' more';
			output += '</li>\n<li>';
			output += (count_5h >= 4) ? '<span class="ach_yes"><span class="ach">Cliques</span> Achievement (5&#x2764; with 4 people) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Cliques</span> Achievement (5&#x2764; with 4 people) requirements not met</span> -- need ' + (4-count_5h) + ' more\n';
			output += '</li>\n<li>';
			output += (count_5h >= 10) ? '<span class="ach_yes"><span class="ach">Networking</span> Achievement (5&#x2764; with 10 people) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Networking</span> Achievement (5&#x2764; with 10 people) requirements not met</span> -- need ' + (10-count_5h) + ' more';
			output += '</li>\n<li>';
			output += (count_5h >= 20) ? '<span class="ach_yes"><span class="ach">Popular</span> Achievement (5&#x2764; with 20 people) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Popular</span> Achievement (5&#x2764; with 20 people) requirements not met</span> -- need ' + (20-count_5h) + ' more';
			output += '</li></ul>\n';
			output += '<span class="result">' + farmer + ' has ' + count_10h + ' friends with 10+ hearts.</span><ul class="ach_list">\n';
			output += '<li>'
			output += (count_10h >= 1) ? '<span class="ach_yes"><span class="ach">Best Friends</span> Achievement (10&#x2764; with 1 person) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Best Friends</span> Achievement (10&#x2764; with 1 person) requirements not met</span> -- need ' + (1-count_10h) + ' more';
			output += '</li>\n<li>';
			output += (count_10h >= 8) ? '<span class="ach_yes"><span class="ach">The Beloved Farmer</span> Achievement (10&#x2764; with 8 people) requirements met</span>' :
				'<span class="ach_no"><span class="ach">The Beloved Farmer</span> Achievement (10&#x2764; with 8 people) requirements not met</span> -- need ' + (8-count_10h) + ' more';
			output += '</li></ul>\n';
			
			var spouse = '(None)';
			var needs = [];
			var count = 0;
			var result = $(xmlDoc).find('player > spouse')
			if (result.length > 0) {
				spouse = result.text();
				count++;
			} else {
				needs.push('Spouse');
			}
			output += '<span class="result">Spouse: ' + spouse + '</span><br />\n';
			var children = '(None)';
			var child_name = [];
			// not sure how to get the [] attribute selectors to recognize xsi:type as valid attribute name, so working around it
			result = $(xmlDoc).find('locations > GameLocation > Characters > NPC').each(function() {
				if ( $(this).attr('xsi:type') == 'Child' ) {
					count++;
					child_name.push($(this).find('name').text());
				}
			});
			if (child_name.length) {
				children = child_name.join(', ');
				if (child_name.length == 1) { 
					needs.push("1 child");
				}
			} else {
				needs.push("2 children");
			}
			output += '<span class="result">Children: ' + children + '</span><ul class="ach_list"><li>\n';
			output += (count >= 3) ? '<span class="ach_yes"><span class="ach">Full House</span> Achievement (Married + 2 kids) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Full House</span> Achievement (Married + 2 kids) requirements not met</span> -- need ' + needs.join('; ');
			output += '</li></ul>\n';
			outElement.innerHTML = output;

			output += '<h3>Farmhouse</h3>\n';
			var houseUpgrades = $(xmlDoc).find('player > houseUpgradeLevel').text();
			output += '<span class="result">Farmhouse has been upgraded ' + houseUpgrades + ' times (3 upgrades are possible).</span><br /><ul class="ach_list">\n';
			output += '<li>'
			output += (houseUpgrades >= 1) ? '<span class="ach_yes"><span class="ach">Moving Up</span> Achievement (1 upgrade) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Moving Up</span> Achievement (1 upgrade) requirements not met</span> -- need ' + (1-houseUpgrades) + ' more';
			output += '</li>\n<li>';
			output += (houseUpgrades >= 2) ? '<span class="ach_yes"><span class="ach">Living Large</span> Achievement (2 upgrades) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Living Large</span> Achievement (2 upgrades) requirements not met</span> -- need ' + (2-houseUpgrades) + ' more';
			output += '</li>\n<li>';
			output += (houseUpgrades >= 3) ? '<span class="ms_yes">All upgrades <span class="ach">(no associated achievement)</span> completed </span>' :
				'<span class="ms_no">All upgrades <span class="ach">(no associated achievement)</span> not completed</span> -- need ' + (3-houseUpgrades) + ' more';
			output += '</li></ul>\n';
			outElement.innerHTML = output;

			output += '<h3>Cooking</h3>\n';
			// cookingRecipes is keyed by name, but recipesCooked is keyed by ObjectInformation ID.
			// Also, some cookingRecipes names are different from the names in ObjectInformation (e.g. Cookies vs Cookie)
			var recipes = {
				194:"Fried Egg",
				195:"Omelet",
				196:"Salad",
				197:"Cheese Cauliflower",
				198:"Baked Fish",
				199:"Parsnip Soup",
				200:"Vegetable Medley",
				201:"Complete Breakfast",
				202:"Fried Calamari",
				203:"Strange Bun",
				204:"Lucky Lunch",
				205:"Fried Mushroom",
				206:"Pizza",
				207:"Bean Hotpot",
				208:"Glazed Yams",
				209:"Carp Surprise",
				210:"Hashbrowns",
				211:"Pancakes",
				212:"Salmon Dinner",
				213:"Fish Taco",
				214:"Crispy Bass",
				215:"Pepper Poppers",
				216:"Bread",
				218:"Tom Kha Soup",
				219:"Trout Soup",
				220:"Chocolate Cake",
				221:"Pink Cake",
				222:"Rhubarb Pie",
				223:"Cookie",
				224:"Spaghetti",
				225:"Fried Eel",
				226:"Spicy Eel",
				227:"Sashimi",
				228:"Maki Roll",
				229:"Tortilla",
				230:"Red Plate",
				231:"Eggplant Parmesan",
				232:"Rice Pudding",
				233:"Ice Cream",
				234:"Blueberry Tart",
				235:"Autumn's Bounty",
				236:"Pumpkin Soup",
				237:"Super Meal",
				238:"Cranberry Sauce",
				239:"Stuffing",
				240:"Farmer's Lunch",
				241:"Survival Burger",
				242:"Dish O' The Sea",
				243:"Miner's Treat",
				244:"Roots Platter",
				456:"Algae Soup",
				457:"Pale Broth",
				604:"Plum Pudding",
				605:"Artichoke Dip",
				606:"Stir Fry",
				607:"Roasted Hazelnuts",
				608:"Pumpkin Pie",
				609:"Radish Salad",
				610:"Fruit Salad",
				611:"Blackberry Cobbler",
				612:"Cranberry Candy",
				618:"Bruschetta",
				648:"Coleslaw",
				649:"Fiddlehead Risotto",
				651:"Poppyseed Muffin",
				727:"Chowder",
				728:"Fish Stew",
				729:"Escargot",
				730:"Lobster Bisque",
				731:"Maple Bar",
				732:"Crab Cakes",
			};
			var recipe_count = Object.keys(recipes).length;
			var recipeTranslate = {
				"Cheese Cauli.":"Cheese Cauliflower",
				"Cookies":"Cookie",
				"Cran. Sauce":"Cranberry Sauce",
				"Dish o' The Sea":"Dish O' The Sea",
				"Eggplant Parm.":"Eggplant Parmesan",
				"Vegetable Stew":"Vegetable Medley",
			};
			var known = {};
			var known_count = 0;
			var crafted = {};
			var craft_count = 0;
			
			$(xmlDoc).find('player > cookingRecipes > item').each(function() {
				var id = $(this).find('key > string').text();
				var num = $(this).find('value > int').text();
				if (id in recipeTranslate) {
					id = recipeTranslate[id];
				}
				known[id] = num;
				known_count++;
			});
			$(xmlDoc).find('player > recipesCooked > item').each(function() {
				var id = $(this).find('key > int').text();
				var num = $(this).find('value > int').text();
				// Do we need to check that num>0?
				crafted[recipes[id]] = num;
				craft_count++;
			});
			
			output += '<span class="result">' + farmer + ' knows  ' + known_count + ' recipes and has cooked ' + craft_count + 
				' of them (out of ' + recipe_count + ' total).</span><ul class="ach_list">\n';
			output += '<li>'
			output += (craft_count >= 10) ? '<span class="ach_yes"><span class="ach">Cook</span> Achievement (cook 10 different recipes) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Cook</span> Achievement (cook 10 different recipes) requirements not met</span> -- need ' + (10-craft_count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= 25) ? '<span class="ach_yes"><span class="ach">Sous Chef</span> Achievement (cook 25 different recipes) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Sous Chef</span> Achievement (cook 25 different recipes) requirements not met</span> -- need ' + (25-craft_count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= recipe_count) ? '<span class="ach_yes"><span class="ach">Gourmet Chef</span> Achievement (cook every recipe) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Gourmet Chef</span> Achievement (cook every recipe) requirements not met</span> -- need ' + (recipe_count-craft_count) + ' more';
			output += '</li></ul>\n';
			// We are assuming it is impossible to craft something without knowing the recipe.
			if (craft_count < recipe_count) {
				var need_k = [];
				var need_c = [];
				for (var id in recipes) {
					var r = recipes[id];
					if (!known.hasOwnProperty(r)) {
						need_k.push('<li>' + r + '</li>');
					} else if (!crafted.hasOwnProperty(r)) {
						need_c.push('<li>' + r + '</li>');
					} 
				}
				output += '<span class="need">Left to cook:<ul>'
				if (need_c.length > 0) {
					output += '<li>Known Recipes<ol>' + need_c.sort().join('') + '</ol></li>\n';
				}
				if (need_k.length > 0) {
					output += '<li>Unknown Recipes<ol>' + need_k.sort().join('') + '</ol></li>\n';
				}

				output += '</ul></span>\n';
			}
			outElement.innerHTML = output;

			output += '<h3>Crafting</h3>\n';
			// Manually listing all crafting recipes in the order they appear on http://stardewvalleywiki.com/Crafting
			// Also, once again there is a text mismatch
			recipes = [	"Cherry Bomb", "Bomb", "Mega Bomb",
							"Gate", "Wood Fence", "Stone Fence", "Iron Fence", "Hardwood Fence",
							"Sprinkler", "Quality Sprinkler", "Iridium Sprinkler",
							"Mayonnaise Machine", "Bee House", "Preserves Jar", "Cheese Press", "Loom", "Keg", "Oil Maker", "Cask",
							"Basic Fertilizer", "Quality Fertilizer", "Speed-Gro", "Deluxe Speed-Gro",
								"Basic Retaining Soil", "Quality Retaining Soil",
							"Wild Seeds (Sp)", "Wild Seeds (Su)", "Wild Seeds (Fa)", "Wild Seeds (Wi)", "Ancient Seeds",
							"Wood Floor", "Straw Floor", "Weathered Floor", "Crystal Floor", "Stone Floor",
								"Wood Path", "Gravel Path", "Cobblestone Path", "Stepping Stone Path", "Crystal Path",
							"Spinner", "Trap Bobber", "Cork Bobber", "Treasure Hunter", "Dressed Spinner", "Barbed Hook",
								"Magnet", "Bait", "Wild Bait", "Crab Pot",
							"Sturdy Ring", "Warrior Ring", "Ring of Yoba", "Iridium Band",
							"Field Snack", "Life Elixir", "Oil of Garlic",
							"Torch", "Campfire", "Wooden Brazier", "Stone Brazier", "Gold Brazier", "Carved Brazier", "Stump Brazier",
								"Barrel Brazier", "Skull Brazier", "Marble Brazier", "Wood Lamp-post", "Iron Lamp-post", "Jack-O-Lantern",
							"Chest", "Furnace", "Scarecrow", "Seed Maker", "Staircase", "Explosive Ammo", "Transmute (Fe)", "Transmute (Au)",
								"Crystalarium", "Charcoal Kiln", "Lightning Rod", "Recycling Machine", "Tapper", "Worm Bin",
								"Slime Egg-Press", "Slime Incubator", "Warp Totem: Beach", "Warp Totem: Mountains", "Warp Totem: Farm",
								"Rain Totem", "Tub o' Flowers", "Wicked Statue", "Flute Block", "Drum Block" ];
			recipeTranslate = {
				"Oil Of Garlic":"Oil of Garlic"
			};
			known = {};
			known_count = 0;
			craft_count = 0;
			need_k = [];
			need_c = [];
			
			$(xmlDoc).find('player > craftingRecipes > item').each(function() {
				var id = $(this).find('key > string').text();
				var num = $(this).find('value > int').text();
				if (id in recipeTranslate) {
					id = recipeTranslate[id];
				}
				known[id] = num;
				known_count++;
				if (num > 0) {
					craft_count++;
				} else {
					need_c.push('<li>' + id + '</li>');
				}
			});

			output += '<span class="result">' + farmer + ' knows ' + known_count + ' recipes and has crafted ' + craft_count + 
				' of them (out of ' + recipes.length + ' total).</span><ul class="ach_list">\n';
			output += '<li>'
			output += (craft_count >= 15) ? '<span class="ach_yes"><span class="ach">D.I.Y.</span> Achievement (craft 15 different items) requirements met</span>' :
				'<span class="ach_no"><span class="ach">D.I.Y.</span> Achievement (craft 15 different items) requirements not met</span> -- need ' + (15-craft_count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= 30) ? '<span class="ach_yes"><span class="ach">Artisan</span> Achievement (craft 30 different items) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Artisan</span> Achievement (craft 30 different items) requirements not met</span> -- need ' + (30-craft_count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= recipe_count) ? '<span class="ach_yes"><span class="ach">Craft Master</span> Achievement (craft every item) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Craft Master</span> Achievement (craft every item) requirements not met</span> -- need ' + (recipes.length-craft_count) + ' more';
			output += '</li></ul>\n';
			if (craft_count < recipes.length) {
				output += '<span class="need">Left to craft:<ul>';
				
				if (need_c.length > 0) {
					output += '<li>Known Recipes<ol>' + need_c.sort().join('') + '</ol></li>\n';
				}

				if (known_count < recipes.length) {
					var need_k = [];
					for (var id in recipes) {
						var r = recipes[id];
						if (!known.hasOwnProperty(r)) {
							need_k.push('<li>' + r + '</li>');
						} 
					}
					output += '<li>Unknown Recipes<ol>' + need_k.sort().join('') + '</ol></li>';
				}
				output += '</ul></span>\n';
			}
			outElement.innerHTML = output;
				
			output += '<h3>Fishing</h3>\n';
			// Fish from ObjectInformation file, keyed by ID
			// Clam (372) will show up in the save, but is category "Basic -23" and is not counted in the type achievements.
			recipes = {
				// "Fish" category
				152:"Seaweed",
				153:"Green Algae",
				157:"White Algae",
				// "Fish -4" category
				128:"Pufferfish",
				129:"Anchovy",
				130:"Tuna",
				131:"Sardine",
				132:"Bream",
				136:"Largemouth Bass",
				137:"Smallmouth Bass",
				138:"Rainbow Trout",
				139:"Salmon",
				140:"Walleye",
				141:"Perch",
				142:"Carp",
				143:"Catfish",
				144:"Pike",
				145:"Sunfish",
				146:"Red Mullet",
				147:"Herring",
				148:"Eel",
				149:"Octopus",
				150:"Red Snapper",
				151:"Squid",
				154:"Sea Cucumber",
				155:"Super Cucumber",
				156:"Ghostfish",
				158:"Stonefish",
				159:"Crimsonfish",
				160:"Angler",
				161:"Ice Pip",
				162:"Lava Eel",
				163:"Legend",
				164:"Sandfish",
				165:"Scorpion Carp",
				682:"Mutant Carp",
				698:"Sturgeon",
				699:"Tiger Trout",
				700:"Bullhead",
				701:"Tilapia",
				702:"Chub",
				704:"Dorado",
				705:"Albacore",
				706:"Shad",
				707:"Lingcod",
				708:"Halibut",
				715:"Lobster",
				716:"Crayfish",
				717:"Crab",
				718:"Cockle",
				719:"Mussel",
				720:"Shrimp",
				721:"Snail",
				722:"Periwinkle",
				723:"Oyster",
				734:"Woodskip",
				775:"Glacierfish",
				795:"Void Salmon",
				796:"Slimejack",
			};
			recipe_count = Object.keys(recipes).length;
			// We will organically add up the count, but this should match a total count elsewhere in the save
			// (stats > fishCaught) and (stats > FishCaught)
			count = 0;
			craft_count = 0; // for fish types
			known = [];
			
			$(xmlDoc).find('player > fishCaught > item').each(function() {
				var id = $(this).find('key > int').text();
				var num = Number($(this).find('value > ArrayOfInt > int').first().text());
				if (id != 372 && num > 0) {
					craft_count++;
					count += num;
					known[recipes[id]]=num;
				}
			});

			output += '<span class="result">' + farmer + ' has caught ' + count + ' total fish of ' + craft_count + 
				' different types (out of ' + recipe_count + ' total).</span><ul class="ach_list">\n';
			output += '<li>'
			output += (count >= 100) ? '<span class="ach_yes"><span class="ach">Mother Catch</span> Achievement (catch 100 fish) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Mother Catch</span> Achievement (catch 100 fish) requirements not met</span> -- need ' + (100-count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= 10) ? '<span class="ach_yes"><span class="ach">Fisherman</span> Achievement (catch 10 different fish) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Fisherman</span> Achievement (catch 10 different fish) requirements not met</span> -- need ' + (10-craft_count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= 24) ? '<span class="ach_yes"><span class="ach">Ol\' Mariner</span> Achievement (catch 24 different fish) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Ol\' Mariner</span> Achievement (catch 24 different fish) requirements not met</span> -- need ' + (24-craft_count) + ' more';
			output += '</li>\n<li>';
			output += (craft_count >= recipe_count) ? '<span class="ach_yes"><span class="ach">Master Angler</span> Achievement (catch every fish) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Master Angler</span> Achievement (catch every fish) requirements not met</span> -- need ' + (recipe_count-craft_count) + ' more';
			output += '</li></ul>\n';
			if (craft_count < recipe_count) {
				need = [];
				for (var id in recipes) {
					var r = recipes[id];
					if (!known.hasOwnProperty(r)) {
						need.push('<li>' + r + '</li>');
					}
				}
				output += '<span class="need">Left to catch:<ol>' + need.sort().join('') + '</ol></span>\n';
			}
			outElement.innerHTML = output;

			output += '<h3>Basic Shipping</h3>\n';
			// Basic shipping achieve details are not easy to pull from decompiled source. Lots of filtering out of things
			// from ObjectInformation in StardewValley.Utility.hasFarmerShippedAllItems() with additional calls to
			// StardewValley.Object.isPotentialBasicShippedCategory().
			// For now, we will simply assume it matches the Collections page and hardcode everything there
			// using wiki page http://stardewvalleywiki.com/Collections as a guideline.
			recipes = {
				16:"Wild Horseradish",
				18:"Daffodil",
				20:"Leek",
				22:"Dandelion",
				24:"Parsnip",
				78:"Cave Carrot",
				88:"Coconut",
				90:"Cactus Fruit",
				92:"Sap",
				174:"Large Egg (White)",
				176:"Egg (White)",
				180:"Egg (Brown)",
				182:"Large Egg (Brown)",
				184:"Milk",
				186:"Large Milk",
				188:"Green Bean",
				190:"Cauliflower",
				192:"Potato",
				248:"Garlic",
				250:"Kale",
				252:"Rhubarb",
				254:"Melon",
				256:"Tomato",
				257:"Morel",
				258:"Blueberry",
				259:"Fiddlehead Fern",
				260:"Hot Pepper",
				262:"Wheat",
				264:"Radish",
				266:"Red Cabbage",
				268:"Starfruit",
				270:"Corn",
				272:"Eggplant",
				274:"Artichoke",
				276:"Pumpkin",
				278:"Bok Choy",
				280:"Yam",
				281:"Chanterelle",
				282:"Cranberries",
				283:"Holly",
				284:"Beet",
				296:"Salmonberry",
				300:"Amaranth",
				303:"Pale Ale",
				304:"Hops",
				305:"Void Egg",
				306:"Mayonnaise",
				307:"Duck Mayonnaise",
				308:"Void Mayonnaise",
				330:"Clay",
				334:"Copper Bar",
				335:"Iron Bar",
				336:"Gold Bar",
				337:"Iridium Bar",
				338:"Refined Quartz",
				340:"Honey",
				342:"Pickles",
				344:"Jelly",
				346:"Beer",
				348:"Wine",
				350:"Juice",
				372:"Clam",
				376:"Poppy",
				378:"Copper Ore",
				380:"Iron Ore",
				382:"Coal",
				384:"Gold Ore",
				386:"Iridium Ore",
				388:"Wood",
				390:"Stone",
				392:"Nautilus Shell",
				393:"Coral",
				394:"Rainbow Shell",
				396:"Spice Berry",
				397:"Sea Urchin",
				398:"Grape",
				399:"Spring Onion",
				400:"Strawberry",
				402:"Sweet Pea",
				404:"Common Mushroom",
				406:"Wild Plum",
				408:"Hazelnut",
				410:"Blackberry",
				412:"Winter Root",
				414:"Crystal Fruit",
				416:"Snow Yam",
				417:"Sweet Gem Berry",
				418:"Crocus",
				420:"Red Mushroom",
				421:"Sunflower",
				422:"Purple Mushroom",
				424:"Cheese",
				426:"Goat Cheese",
				428:"Cloth",
				430:"Truffle",
				432:"Truffle Oil",
				433:"Coffee Bean",
				436:"Goat Milk",
				438:"L. Goat Milk",
				440:"Wool",
				442:"Duck Egg",
				444:"Duck Feather",
				446:"Rabbit's Foot",
				454:"Ancient Fruit",
				459:"Mead",
				591:"Tulip",
				593:"Summer Spangle",
				595:"Fairy Rose",
				597:"Blue Jazz",
				613:"Apple",
				634:"Apricot",
				635:"Orange",
				636:"Peach",
				637:"Pomegranate",
				638:"Cherry",
				684:"Bug Meat",
				709:"Hardwood",
				724:"Maple Syrup",
				725:"Oak Resin",
				726:"Pine Tar",
				766:"Slime",
				767:"Bat Wing",
				768:"Solar Essence",
				769:"Void Essence",
				771:"Fiber",
				787:"Battery Pack",
			};
			recipe_count = Object.keys(recipes).length;
			var crafted = {};
			var craft_count = 0;
			
			$(xmlDoc).find('player > basicShipped > item').each(function() {
				var id = $(this).find('key > int').text();
				var num = $(this).find('value > int').text();
				if (recipes.hasOwnProperty(id) && num > 0) {
					crafted[recipes[id]] = num;
					craft_count++;
				}
			});
			
			output += '<span class="result">' + farmer + ' has shipped  ' + craft_count + 
				' basic items (out of ' + recipe_count + ' total).</span><ul class="ach_list">\n';
			output += '<li>'
			output += (craft_count >= recipe_count) ? '<span class="ach_yes"><span class="ach">Full Shipment</span> Achievement (ship every item) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Full Shipment</span> Achievement (ship every item) requirements not met</span> -- need ' + (recipe_count-craft_count) + ' more';
			output += '</li></ul>\n';
			if (craft_count < recipe_count) {
				var need = [];
				for (var id in recipes) {
					var r = recipes[id];
					if (!crafted.hasOwnProperty(r)) {
						need.push('<li>' + r + '</li>');
					} 
				}
				output += '<span class="need">Left to ship:<ol>' + need.sort().join('') + '</ol></span>\n';
			}
			outElement.innerHTML = output;

			output += '<h3>Crop Shipping</h3>\n';
			// Relevant IDs were pulled from decompiled source - StardewValley.Stats.checkForShippingAchievments()
			// First, everything for polyculture from ObjectInformation file, keyed by ID
			var poly_crops = {
				// Some, but not all of "Basic -75" category (All veg except fiddlehead)
				24:"Parsnip",
				188:"Green Bean",
				190:"Cauliflower",
				192:"Potato",
				248:"Garlic",
				250:"Kale",
				256:"Tomato",
				262:"Wheat",
				264:"Radish",
				266:"Red Cabbage",
				270:"Corn",
				272:"Eggplant",
				274:"Artichoke",
				276:"Pumpkin",
				278:"Bok Choy",
				280:"Yam",
				284:"Beet",
				300:"Amaranth",
				304:"Hops",
				// Some, but not all of "Basic -79" category (All fruit except Ancient, tree & forageables)
				252:"Rhubarb",
				254:"Melon",
				258:"Blueberry",
				260:"Hot Pepper",
				268:"Starfruit",
				282:"Cranberries",
				398:"Grape",
				400:"Strawberry",
				// Others
				433:"Coffee Bean",
			};
			var recipe_count = Object.keys(poly_crops).length;
			// monoculture has 5 extra allowed crops
			var mono_extras = {
				// Ancient Fruit and 4 of the "Basic -80" flowers
				454:"Ancient Fruit",
				591:"Tulip",
				593:"Summer Spangle",
				595:"Fairy Rose",
				597:"Blue Jazz",
			};
			crafted = {};
			craft_count = 0;
			var max_ship = 0;
			var max_crop = "of any crop";
			
			$(xmlDoc).find('player > basicShipped > item').each(function() {
				var id = $(this).find('key > int').text();
				var num = Number($(this).find('value > int').text());
				if (poly_crops.hasOwnProperty(id)) {
					crafted[poly_crops[id]] = num;
					if (num >= 15) {
						craft_count++;
					}
					if (num > max_ship) {
						max_ship = num;
						max_crop = poly_crops[id];
					}
				} else if (mono_extras.hasOwnProperty(id)) {
					if (num > max_ship) {
						max_ship = num;
						max_crop = mono_extras[id];
					}
				}
			});

			output += (max_ship > 0) ? '<span class="result">' + farmer + ' has shipped ' + max_crop + ' the most (' + max_ship + ').</span>' :
				'<span class="result">' + farmer + ' has not shipped any crops yet.</span>';
			output += '<ul class="ach_list"><li>\n';
			output += (max_ship >= 300) ? '<span class="ach_yes"><span class="ach">Monoculture</span> Achievement (ship 300 of one crop) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Monoculture</span> Achievement (ship 300 of one crop) requirements not met</span> -- need ' + (300-max_ship) + ' more ' + max_crop;
			output += '</li></ul>\n';
			output += '<span class="result">' + farmer + ' has shipped 15 or more of each of ' + craft_count + 
				' different crops (out of ' + recipe_count + ' total).</span><ul class="ach_list">\n<li>';
			output += (craft_count >= recipe_count) ? '<span class="ach_yes"><span class="ach">Polyculture</span> Achievement (ship 15 of each crop) requirements met</span>' :
				'<span class="ach_no"><span class="ach">Polyculture</span> Achievement (ship 15 of each crop) requirements not met</span> -- need more of ' + (recipe_count-craft_count) + ' crops';
			output += '</li></ul>\n';
			if (craft_count < recipe_count) {
				var need = [];
				for (var id in poly_crops) {
					var r = poly_crops[id];
					if (!crafted.hasOwnProperty(r)) {
						need.push('<li>' + r + ' (15 more)</li>')
					} else {
						var n = Number(crafted[r]);
						if (n < 15) {
							need.push('<li>' + r + ' (' + (15-n) + ' more)</li>');
						}
					}
				}
				output += '<span class="need">Left to ship:<ol>' + need.sort().join('') + '</ol></span>\n';
			}
			outElement.innerHTML = output;

			
			
			//TODO: remaining achievments
			// Joja & CC.
			// - CC bundles: locations > GameLocation [attr('xsi:type') == 'CommunityCenter'] > bundles (individual) & areasComplete
			// - Joja? maybe mail
			// Praire King achieves - there is no progress for them so may not bother
			// Mystery of the Stardrops - must find all triggers (mail?)
			// Monster eradication
			// Skills
			// Shipping
			// Help Wanted
			// Museum
			// Bottom of the mines
			//TODO: non-achieve milestones
			// Additional friendships?
			// Grandpa's Evaluation

			// End of checks
		};
		reader.readAsText(file);

	}
	document.getElementById('file_select').addEventListener('change', handleFileSelect, false);
	
}
</script>

</body>
</html>